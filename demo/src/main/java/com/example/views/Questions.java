/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
package com.example.views;

import java.awt.BorderLayout;
import java.awt.CardLayout;
import java.awt.Color;
import java.awt.Cursor;
import java.awt.Dimension;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;

import com.example.controllers.CoursesController;
import com.example.controllers.QuestionController;
import com.example.controllers.SubtopicsController;
import com.example.controllers.TopicsController;
import java.awt.event.MouseListener;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.HashMap;

import javax.swing.BorderFactory;
import javax.swing.Box;
import javax.swing.BoxLayout;
import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JFileChooser;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JScrollBar;
import javax.swing.SwingUtilities;
import javax.swing.filechooser.FileNameExtensionFilter;

/**
 *
 * @author Rian Ramdin
 */
public class Questions extends javax.swing.JPanel {
    private QuestionController qController = new QuestionController();
    
    private HashMap<String, Integer> courseCodeToIDMap = new HashMap<>();
    private CoursesController cController = new CoursesController();
    
    private HashMap<String, Integer> topicNameToIDMap = new HashMap<>();
    private TopicsController tController = new TopicsController();
    
    private HashMap<String, Integer> subtopicNameToIDMap = new HashMap<>();
    private SubtopicsController sController = new SubtopicsController();
    
    private Integer currentQuestionId = null;
    private JPanel lastHighlightedPanel = null;
    
    private static final String DEFAULT_ALL_OPTION = "--All--";
    private static final String DEFAULT_NONE_OPTION = "--None--";

    private String questionImagePath = "";
    private String answer1ImagePath = "";
    private String answer2ImagePath = "";
    private String answer3ImagePath = "";
    private String answer4ImagePath = "";
    
    public Questions() {
        initComponents();

        // Configure scrolling speed
        JScrollBar verticalScrollBar = resultsScrollPane.getVerticalScrollBar();
        verticalScrollBar.setUnitIncrement(16);  // Faster scrolling

        populateDropdowns();
        setupBrowseDropdownListeners();
        setupManageDropdownListeners();
        setupFormatListeners();
        setupImageButtonListeners();

        populateResultsPanel(qController.getQuestionsWithFilter()); // Populate the panel with data from the database
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        ansButtonGroup = new javax.swing.ButtonGroup();
        sortButtonGroup = new javax.swing.ButtonGroup();
        qFormatButtonGroup = new javax.swing.ButtonGroup();
        ansFormatButtonGroup = new javax.swing.ButtonGroup();
        headerPanel = new javax.swing.JPanel();
        returnButton = new javax.swing.JButton();
        helpButton = new javax.swing.JButton();
        questionsLabel = new javax.swing.JLabel();
        questionsTabbedPane = new javax.swing.JTabbedPane();
        manageScrollTab = new javax.swing.JScrollPane();
        manageScrollContentPanel = new javax.swing.JPanel();
        manageControlsPanel = new javax.swing.JPanel();
        newButton = new javax.swing.JButton();
        saveButton = new javax.swing.JButton();
        clearButton = new javax.swing.JButton();
        deleteButton = new javax.swing.JButton();
        manageQuestionPanel = new javax.swing.JPanel();
        questionTF = new javax.swing.JTextField();
        qImageButton = new javax.swing.JButton();
        imagePathTF = new javax.swing.JTextField();
        qFormatLabel = new javax.swing.JLabel();
        qFormatRadioButton1 = new javax.swing.JRadioButton();
        qFormatRadioButton2 = new javax.swing.JRadioButton();
        qFormatRadioButton3 = new javax.swing.JRadioButton();
        manageAnswersPanel = new javax.swing.JPanel();
        ansFormatLabel = new javax.swing.JLabel();
        ansFormatRadioButton1 = new javax.swing.JRadioButton();
        ansFormatRadioButton2 = new javax.swing.JRadioButton();
        ansRadioButton1 = new javax.swing.JRadioButton();
        ansTF1 = new javax.swing.JTextField();
        ansImageButton1 = new javax.swing.JButton();
        ansRadioButton2 = new javax.swing.JRadioButton();
        ansTF2 = new javax.swing.JTextField();
        ansImageButton2 = new javax.swing.JButton();
        ansRadioButton3 = new javax.swing.JRadioButton();
        ansTF3 = new javax.swing.JTextField();
        ansImageButton3 = new javax.swing.JButton();
        ansRadioButton4 = new javax.swing.JRadioButton();
        ansTF4 = new javax.swing.JTextField();
        ansImageButton4 = new javax.swing.JButton();
        manageTagsPanel = new javax.swing.JPanel();
        historyTagsPanel = new javax.swing.JPanel();
        dateCreatedLabel = new javax.swing.JLabel();
        dateCreatedTF = new javax.swing.JTextField();
        dateEditedLabel = new javax.swing.JLabel();
        dateEditedTF = new javax.swing.JTextField();
        dateUsedLabel = new javax.swing.JLabel();
        dateUsedTF = new javax.swing.JTextField();
        usedCountLabel = new javax.swing.JLabel();
        usedCountTF = new javax.swing.JTextField();
        categoryTagsPanel = new javax.swing.JPanel();
        courseLabel = new javax.swing.JLabel();
        courseComboBox = new javax.swing.JComboBox<>();
        topicLabel = new javax.swing.JLabel();
        topicComboBox = new javax.swing.JComboBox<>();
        subtopicLabel = new javax.swing.JLabel();
        subtopicComboBox = new javax.swing.JComboBox<>();
        perfTagsPanel = new javax.swing.JPanel();
        difficultyLabel = new javax.swing.JLabel();
        difficultySpinner = new javax.swing.JSpinner();
        performanceLabel = new javax.swing.JLabel();
        performanceSpinner = new javax.swing.JSpinner();
        discriminationLabel = new javax.swing.JLabel();
        discriminationSpinner = new javax.swing.JSpinner();
        commentPanel = new javax.swing.JPanel();
        commentScrollPane = new javax.swing.JScrollPane();
        commentTextArea = new javax.swing.JTextArea();
        browseTab = new javax.swing.JPanel();
        bOrganizeTabbedPane = new javax.swing.JTabbedPane();
        bFilterScrollTab = new javax.swing.JScrollPane();
        bFilterPanel = new javax.swing.JPanel();
        bUsedPanel = new javax.swing.JPanel();
        bUsedYesCB = new javax.swing.JCheckBox();
        bUsedNoCB = new javax.swing.JCheckBox();
        bDifficultyPanel = new javax.swing.JPanel();
        jSpinner1 = new javax.swing.JSpinner();
        jSpinner2 = new javax.swing.JSpinner();
        bCoursePanel = new javax.swing.JPanel();
        bCourseComboBox = new javax.swing.JComboBox<>();
        bTopicPanel = new javax.swing.JPanel();
        bTopicComboBox = new javax.swing.JComboBox<>();
        bSubtopicPanel = new javax.swing.JPanel();
        bSubtopicComboBox = new javax.swing.JComboBox<>();
        jPanel1 = new javax.swing.JPanel();
        jSpinner3 = new javax.swing.JSpinner();
        jSpinner4 = new javax.swing.JSpinner();
        jPanel2 = new javax.swing.JPanel();
        jSpinner5 = new javax.swing.JSpinner();
        jSpinner6 = new javax.swing.JSpinner();
        bSortTab = new javax.swing.JPanel();
        sortRB1 = new javax.swing.JRadioButton();
        sortRB2 = new javax.swing.JRadioButton();
        sortRB3 = new javax.swing.JRadioButton();
        sortRB4 = new javax.swing.JRadioButton();
        sortRB5 = new javax.swing.JRadioButton();
        sortRB6 = new javax.swing.JRadioButton();
        sortRB7 = new javax.swing.JRadioButton();
        sortRB8 = new javax.swing.JRadioButton();
        sortRB9 = new javax.swing.JRadioButton();
        sortRB10 = new javax.swing.JRadioButton();
        sortRB11 = new javax.swing.JRadioButton();
        jRadioButton1 = new javax.swing.JRadioButton();
        jRadioButton2 = new javax.swing.JRadioButton();
        jRadioButton3 = new javax.swing.JRadioButton();
        jRadioButton4 = new javax.swing.JRadioButton();
        searchPanel = new javax.swing.JPanel();
        searchTF = new javax.swing.JTextField();
        searchButton = new javax.swing.JButton();
        resultsScrollPane = new javax.swing.JScrollPane();
        resultsPanel = new javax.swing.JPanel();

        setLayout(new java.awt.BorderLayout());

        headerPanel.setLayout(new java.awt.BorderLayout());

        returnButton.setText("Return");
        returnButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                returnButtonActionPerformed(evt);
            }
        });
        headerPanel.add(returnButton, java.awt.BorderLayout.LINE_START);

        helpButton.setText("Help");
        helpButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                helpButtonActionPerformed(evt);
            }
        });
        headerPanel.add(helpButton, java.awt.BorderLayout.LINE_END);

        questionsLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        questionsLabel.setText("Questions");
        headerPanel.add(questionsLabel, java.awt.BorderLayout.CENTER);

        add(headerPanel, java.awt.BorderLayout.PAGE_START);

        manageScrollContentPanel.setPreferredSize(new java.awt.Dimension(652, 576));

        manageControlsPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Controls"));

        newButton.setText("New Question");
        newButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                newButtonActionPerformed(evt);
            }
        });
        manageControlsPanel.add(newButton);

        saveButton.setText("Save Question");
        saveButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                saveButtonActionPerformed(evt);
            }
        });
        manageControlsPanel.add(saveButton);

        clearButton.setText("Clear Fields");
        clearButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                clearButtonActionPerformed(evt);
            }
        });
        manageControlsPanel.add(clearButton);

        deleteButton.setText("Delete Question");
        deleteButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                deleteButtonActionPerformed(evt);
            }
        });
        manageControlsPanel.add(deleteButton);

        manageQuestionPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Question"));

        questionTF.setText("Question Text");
        questionTF.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                questionTFFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                questionTFFocusLost(evt);
            }
        });

        qImageButton.setText("Choose Image");
        qImageButton.setEnabled(false);

        imagePathTF.setEditable(false);
        imagePathTF.setText("Image Path");
        imagePathTF.setEnabled(false);
        imagePathTF.setFocusable(false);

        qFormatLabel.setText("Question Format:");

        qFormatButtonGroup.add(qFormatRadioButton1);
        qFormatRadioButton1.setSelected(true);
        qFormatRadioButton1.setText("Text");

        qFormatButtonGroup.add(qFormatRadioButton2);
        qFormatRadioButton2.setText("Image");

        qFormatButtonGroup.add(qFormatRadioButton3);
        qFormatRadioButton3.setText("Text and Image");

        javax.swing.GroupLayout manageQuestionPanelLayout = new javax.swing.GroupLayout(manageQuestionPanel);
        manageQuestionPanel.setLayout(manageQuestionPanelLayout);
        manageQuestionPanelLayout.setHorizontalGroup(
            manageQuestionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(manageQuestionPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(manageQuestionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(manageQuestionPanelLayout.createSequentialGroup()
                        .addComponent(qImageButton)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(imagePathTF))
                    .addComponent(questionTF)
                    .addGroup(manageQuestionPanelLayout.createSequentialGroup()
                        .addComponent(qFormatLabel)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(qFormatRadioButton1)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(qFormatRadioButton2)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(qFormatRadioButton3)
                        .addGap(0, 0, Short.MAX_VALUE)))
                .addContainerGap())
        );
        manageQuestionPanelLayout.setVerticalGroup(
            manageQuestionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(manageQuestionPanelLayout.createSequentialGroup()
                .addGroup(manageQuestionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(qFormatLabel)
                    .addComponent(qFormatRadioButton1)
                    .addComponent(qFormatRadioButton2)
                    .addComponent(qFormatRadioButton3))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(questionTF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(manageQuestionPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(imagePathTF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(qImageButton))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        manageAnswersPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Answers"));

        ansFormatLabel.setText("Answer Format:");

        ansFormatButtonGroup.add(ansFormatRadioButton1);
        ansFormatRadioButton1.setSelected(true);
        ansFormatRadioButton1.setText("Text");

        ansFormatButtonGroup.add(ansFormatRadioButton2);
        ansFormatRadioButton2.setText("Images");

        ansButtonGroup.add(ansRadioButton1);

        ansTF1.setText("Answer 1");
        ansTF1.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                ansTF1FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                ansTF1FocusLost(evt);
            }
        });

        ansImageButton1.setText("Choose Image");
        ansImageButton1.setEnabled(false);

        ansButtonGroup.add(ansRadioButton2);

        ansTF2.setText("Answer 2");
        ansTF2.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                ansTF2FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                ansTF2FocusLost(evt);
            }
        });

        ansImageButton2.setText("Choose Image");
        ansImageButton2.setEnabled(false);

        ansButtonGroup.add(ansRadioButton3);

        ansTF3.setText("Answer 3");
        ansTF3.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                ansTF3FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                ansTF3FocusLost(evt);
            }
        });

        ansImageButton3.setText("Choose Image");
        ansImageButton3.setEnabled(false);

        ansButtonGroup.add(ansRadioButton4);

        ansTF4.setText("Answer 4");
        ansTF4.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                ansTF4FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                ansTF4FocusLost(evt);
            }
        });

        ansImageButton4.setText("Choose Image");
        ansImageButton4.setEnabled(false);

        javax.swing.GroupLayout manageAnswersPanelLayout = new javax.swing.GroupLayout(manageAnswersPanel);
        manageAnswersPanel.setLayout(manageAnswersPanelLayout);
        manageAnswersPanelLayout.setHorizontalGroup(
            manageAnswersPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(manageAnswersPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(manageAnswersPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(manageAnswersPanelLayout.createSequentialGroup()
                        .addComponent(ansRadioButton1)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(ansTF1)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(ansImageButton1))
                    .addGroup(manageAnswersPanelLayout.createSequentialGroup()
                        .addComponent(ansRadioButton4)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(ansTF4)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(ansImageButton4))
                    .addGroup(manageAnswersPanelLayout.createSequentialGroup()
                        .addComponent(ansRadioButton2)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(ansTF2)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(ansImageButton2))
                    .addGroup(manageAnswersPanelLayout.createSequentialGroup()
                        .addComponent(ansRadioButton3)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(ansTF3)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(ansImageButton3))
                    .addGroup(manageAnswersPanelLayout.createSequentialGroup()
                        .addComponent(ansFormatLabel)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(ansFormatRadioButton1)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(ansFormatRadioButton2)
                        .addGap(0, 0, Short.MAX_VALUE)))
                .addContainerGap())
        );
        manageAnswersPanelLayout.setVerticalGroup(
            manageAnswersPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, manageAnswersPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(manageAnswersPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(ansFormatLabel)
                    .addComponent(ansFormatRadioButton1)
                    .addComponent(ansFormatRadioButton2))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(manageAnswersPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(ansRadioButton1)
                    .addComponent(ansTF1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(ansImageButton1))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(manageAnswersPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(ansRadioButton2)
                    .addComponent(ansTF2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(ansImageButton2))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(manageAnswersPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(ansRadioButton3)
                    .addComponent(ansTF3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(ansImageButton3))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(manageAnswersPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(ansRadioButton4)
                    .addComponent(ansTF4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(ansImageButton4))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        manageTagsPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Tags"));

        historyTagsPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("History Tags"));
        historyTagsPanel.setLayout(new java.awt.GridBagLayout());

        dateCreatedLabel.setText("Date Created:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(7, 5, 5, 5);
        historyTagsPanel.add(dateCreatedLabel, gridBagConstraints);

        dateCreatedTF.setEditable(false);
        dateCreatedTF.setText("--New--");
        dateCreatedTF.setFocusable(false);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 5, 5);
        historyTagsPanel.add(dateCreatedTF, gridBagConstraints);

        dateEditedLabel.setText("Last Edited:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 10;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(7, 5, 5, 5);
        historyTagsPanel.add(dateEditedLabel, gridBagConstraints);

        dateEditedTF.setEditable(false);
        dateEditedTF.setText("--New--");
        dateEditedTF.setFocusable(false);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 12;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 5, 5);
        historyTagsPanel.add(dateEditedTF, gridBagConstraints);

        dateUsedLabel.setText("Last Used:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 5;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(7, 5, 5, 5);
        historyTagsPanel.add(dateUsedLabel, gridBagConstraints);

        dateUsedTF.setEditable(false);
        dateUsedTF.setText("--Never--");
        dateUsedTF.setFocusable(false);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 7;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 5, 5);
        historyTagsPanel.add(dateUsedTF, gridBagConstraints);

        usedCountLabel.setText("Times Used:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 15;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(7, 5, 5, 5);
        historyTagsPanel.add(usedCountLabel, gridBagConstraints);

        usedCountTF.setEditable(false);
        usedCountTF.setText("0");
        usedCountTF.setFocusable(false);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 17;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 5, 5);
        historyTagsPanel.add(usedCountTF, gridBagConstraints);

        categoryTagsPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Category Tags"));
        categoryTagsPanel.setLayout(new java.awt.GridBagLayout());

        courseLabel.setText("Course:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(7, 5, 5, 5);
        categoryTagsPanel.add(courseLabel, gridBagConstraints);

        courseComboBox.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "course1", "course2", "course3", "course4" }));
        courseComboBox.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                courseComboBoxActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 5, 5);
        categoryTagsPanel.add(courseComboBox, gridBagConstraints);

        topicLabel.setText("Topic:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(7, 5, 5, 5);
        categoryTagsPanel.add(topicLabel, gridBagConstraints);

        topicComboBox.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "topic1", "topic2", "topic3", "topic4" }));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.ipadx = 53;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 5, 5);
        categoryTagsPanel.add(topicComboBox, gridBagConstraints);

        subtopicLabel.setText("Subtopic:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.insets = new java.awt.Insets(7, 5, 5, 5);
        categoryTagsPanel.add(subtopicLabel, gridBagConstraints);

        subtopicComboBox.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "subtopic1", "subtopic2", "subtopic3", "subtopic4" }));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.ipadx = 32;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 5, 5);
        categoryTagsPanel.add(subtopicComboBox, gridBagConstraints);

        perfTagsPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Performance Metrics"));
        perfTagsPanel.setToolTipText("");
        perfTagsPanel.setLayout(new java.awt.GridBagLayout());

        difficultyLabel.setText("Difficulty:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(7, 5, 5, 5);
        perfTagsPanel.add(difficultyLabel, gridBagConstraints);

        difficultySpinner.setModel(new javax.swing.SpinnerNumberModel(Float.valueOf(0.0f), Float.valueOf(0.0f), Float.valueOf(1.0f), Float.valueOf(0.01f)));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 5, 5);
        perfTagsPanel.add(difficultySpinner, gridBagConstraints);

        performanceLabel.setText("Performance:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(7, 5, 5, 5);
        perfTagsPanel.add(performanceLabel, gridBagConstraints);

        performanceSpinner.setModel(new javax.swing.SpinnerNumberModel(Float.valueOf(0.0f), Float.valueOf(0.0f), Float.valueOf(1.0f), Float.valueOf(0.01f)));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 5, 5);
        perfTagsPanel.add(performanceSpinner, gridBagConstraints);

        discriminationLabel.setText("Discrimination:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(7, 5, 5, 5);
        perfTagsPanel.add(discriminationLabel, gridBagConstraints);

        discriminationSpinner.setModel(new javax.swing.SpinnerNumberModel(Float.valueOf(0.0f), Float.valueOf(0.0f), Float.valueOf(1.0f), Float.valueOf(0.01f)));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 5, 5);
        perfTagsPanel.add(discriminationSpinner, gridBagConstraints);

        commentPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Comment"));

        commentScrollPane.setHorizontalScrollBarPolicy(javax.swing.ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);

        commentTextArea.setColumns(20);
        commentTextArea.setRows(5);
        commentScrollPane.setViewportView(commentTextArea);

        javax.swing.GroupLayout commentPanelLayout = new javax.swing.GroupLayout(commentPanel);
        commentPanel.setLayout(commentPanelLayout);
        commentPanelLayout.setHorizontalGroup(
            commentPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(commentPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(commentScrollPane, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                .addContainerGap())
        );
        commentPanelLayout.setVerticalGroup(
            commentPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(commentPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(commentScrollPane)
                .addContainerGap())
        );

        javax.swing.GroupLayout manageTagsPanelLayout = new javax.swing.GroupLayout(manageTagsPanel);
        manageTagsPanel.setLayout(manageTagsPanelLayout);
        manageTagsPanelLayout.setHorizontalGroup(
            manageTagsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(manageTagsPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(manageTagsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(manageTagsPanelLayout.createSequentialGroup()
                        .addComponent(historyTagsPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(manageTagsPanelLayout.createSequentialGroup()
                        .addComponent(categoryTagsPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(perfTagsPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(commentPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                .addContainerGap())
        );
        manageTagsPanelLayout.setVerticalGroup(
            manageTagsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(manageTagsPanelLayout.createSequentialGroup()
                .addComponent(historyTagsPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(manageTagsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(commentPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(perfTagsPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(categoryTagsPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );

        javax.swing.GroupLayout manageScrollContentPanelLayout = new javax.swing.GroupLayout(manageScrollContentPanel);
        manageScrollContentPanel.setLayout(manageScrollContentPanelLayout);
        manageScrollContentPanelLayout.setHorizontalGroup(
            manageScrollContentPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(manageScrollContentPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(manageScrollContentPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(manageTagsPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(manageControlsPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(manageAnswersPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(manageQuestionPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        manageScrollContentPanelLayout.setVerticalGroup(
            manageScrollContentPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(manageScrollContentPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(manageControlsPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(manageQuestionPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(manageAnswersPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(manageTagsPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        manageScrollTab.setViewportView(manageScrollContentPanel);

        questionsTabbedPane.addTab("Manage", manageScrollTab);

        bFilterScrollTab.setBorder(null);

        bUsedPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Used"));

        bUsedYesCB.setText("Yes");

        bUsedNoCB.setText("No");

        javax.swing.GroupLayout bUsedPanelLayout = new javax.swing.GroupLayout(bUsedPanel);
        bUsedPanel.setLayout(bUsedPanelLayout);
        bUsedPanelLayout.setHorizontalGroup(
            bUsedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(bUsedPanelLayout.createSequentialGroup()
                .addGroup(bUsedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(bUsedYesCB)
                    .addComponent(bUsedNoCB))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        bUsedPanelLayout.setVerticalGroup(
            bUsedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(bUsedPanelLayout.createSequentialGroup()
                .addComponent(bUsedYesCB)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(bUsedNoCB)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        bDifficultyPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Difficulty"));

        jSpinner1.setModel(new javax.swing.SpinnerNumberModel(Float.valueOf(0.0f), Float.valueOf(0.0f), Float.valueOf(1.0f), Float.valueOf(0.01f)));

        jSpinner2.setModel(new javax.swing.SpinnerNumberModel(Float.valueOf(1.0f), Float.valueOf(0.0f), Float.valueOf(1.0f), Float.valueOf(0.01f)));

        javax.swing.GroupLayout bDifficultyPanelLayout = new javax.swing.GroupLayout(bDifficultyPanel);
        bDifficultyPanel.setLayout(bDifficultyPanelLayout);
        bDifficultyPanelLayout.setHorizontalGroup(
            bDifficultyPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, bDifficultyPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(bDifficultyPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jSpinner2)
                    .addComponent(jSpinner1))
                .addContainerGap())
        );
        bDifficultyPanelLayout.setVerticalGroup(
            bDifficultyPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(bDifficultyPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jSpinner1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jSpinner2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        bCoursePanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Course"));

        bCourseComboBox.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Course 1", "Course 2", "Course 3", "Course 4" }));

        javax.swing.GroupLayout bCoursePanelLayout = new javax.swing.GroupLayout(bCoursePanel);
        bCoursePanel.setLayout(bCoursePanelLayout);
        bCoursePanelLayout.setHorizontalGroup(
            bCoursePanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, bCoursePanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(bCourseComboBox, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
        bCoursePanelLayout.setVerticalGroup(
            bCoursePanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(bCoursePanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(bCourseComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        bTopicPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Topic"));

        bTopicComboBox.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Topic 1", "Topic 2", "Topic 3", "Topic 4" }));

        javax.swing.GroupLayout bTopicPanelLayout = new javax.swing.GroupLayout(bTopicPanel);
        bTopicPanel.setLayout(bTopicPanelLayout);
        bTopicPanelLayout.setHorizontalGroup(
            bTopicPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(bTopicPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(bTopicComboBox, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
        bTopicPanelLayout.setVerticalGroup(
            bTopicPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(bTopicPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(bTopicComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        bSubtopicPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Sub-Topic"));

        bSubtopicComboBox.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Sub-Topic 1", "Sub-Topic 2", "Sub-Topic 3", "Sub-Topic 4" }));

        javax.swing.GroupLayout bSubtopicPanelLayout = new javax.swing.GroupLayout(bSubtopicPanel);
        bSubtopicPanel.setLayout(bSubtopicPanelLayout);
        bSubtopicPanelLayout.setHorizontalGroup(
            bSubtopicPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(bSubtopicPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(bSubtopicComboBox, 0, 152, Short.MAX_VALUE)
                .addContainerGap())
        );
        bSubtopicPanelLayout.setVerticalGroup(
            bSubtopicPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(bSubtopicPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(bSubtopicComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder("Performance"));

        jSpinner3.setModel(new javax.swing.SpinnerNumberModel(Float.valueOf(0.0f), Float.valueOf(0.0f), Float.valueOf(1.0f), Float.valueOf(0.01f)));

        jSpinner4.setModel(new javax.swing.SpinnerNumberModel(Float.valueOf(1.0f), Float.valueOf(0.0f), Float.valueOf(1.0f), Float.valueOf(0.01f)));

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jSpinner3)
                    .addComponent(jSpinner4))
                .addContainerGap())
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jSpinner3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jSpinner4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder("Discrimination"));

        jSpinner5.setModel(new javax.swing.SpinnerNumberModel(Float.valueOf(0.0f), Float.valueOf(0.0f), Float.valueOf(1.0f), Float.valueOf(0.01f)));

        jSpinner6.setModel(new javax.swing.SpinnerNumberModel(Float.valueOf(1.0f), Float.valueOf(0.0f), Float.valueOf(1.0f), Float.valueOf(0.01f)));

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jSpinner6)
                    .addComponent(jSpinner5))
                .addContainerGap())
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jSpinner5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jSpinner6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout bFilterPanelLayout = new javax.swing.GroupLayout(bFilterPanel);
        bFilterPanel.setLayout(bFilterPanelLayout);
        bFilterPanelLayout.setHorizontalGroup(
            bFilterPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(bFilterPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(bFilterPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(bUsedPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(bSubtopicPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(bTopicPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(bCoursePanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(bDifficultyPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        bFilterPanelLayout.setVerticalGroup(
            bFilterPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(bFilterPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(bUsedPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(bDifficultyPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(bCoursePanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(bTopicPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(bSubtopicPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        bFilterScrollTab.setViewportView(bFilterPanel);

        bOrganizeTabbedPane.addTab("Filter", bFilterScrollTab);

        sortButtonGroup.add(sortRB1);
        sortRB1.setSelected(true);
        sortRB1.setText("Default");

        sortButtonGroup.add(sortRB2);
        sortRB2.setText("Images First");

        sortButtonGroup.add(sortRB3);
        sortRB3.setText("Text First");

        sortButtonGroup.add(sortRB4);
        sortRB4.setText("Last Used (Oldest First)");

        sortButtonGroup.add(sortRB5);
        sortRB5.setText("Last Used (Newest First)");

        sortButtonGroup.add(sortRB6);
        sortRB6.setText("Date Created (Oldest First)");

        sortButtonGroup.add(sortRB7);
        sortRB7.setText("Date Created (Newest First)");

        sortButtonGroup.add(sortRB8);
        sortRB8.setText("Times Used (Least First)");

        sortButtonGroup.add(sortRB9);
        sortRB9.setText("Times Used (Most First)");

        sortButtonGroup.add(sortRB10);
        sortRB10.setText("Difficulty (Easy First)");

        sortButtonGroup.add(sortRB11);
        sortRB11.setText("Difficulty (Hard First)");

        sortButtonGroup.add(jRadioButton1);
        jRadioButton1.setText("Performance (Lowest First)");

        sortButtonGroup.add(jRadioButton2);
        jRadioButton2.setText("Performance (Highest First)");

        sortButtonGroup.add(jRadioButton3);
        jRadioButton3.setText("Discrimination (Lowest First)");

        sortButtonGroup.add(jRadioButton4);
        jRadioButton4.setText("Discrimination (Highest First)");

        javax.swing.GroupLayout bSortTabLayout = new javax.swing.GroupLayout(bSortTab);
        bSortTab.setLayout(bSortTabLayout);
        bSortTabLayout.setHorizontalGroup(
            bSortTabLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(bSortTabLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(bSortTabLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(sortRB1)
                    .addComponent(sortRB2)
                    .addComponent(sortRB3)
                    .addComponent(sortRB4)
                    .addComponent(sortRB5)
                    .addComponent(sortRB6)
                    .addComponent(sortRB7)
                    .addComponent(sortRB8)
                    .addComponent(sortRB9)
                    .addComponent(sortRB10)
                    .addComponent(sortRB11)
                    .addComponent(jRadioButton1)
                    .addComponent(jRadioButton2)
                    .addComponent(jRadioButton3)
                    .addComponent(jRadioButton4))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        bSortTabLayout.setVerticalGroup(
            bSortTabLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(bSortTabLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(sortRB1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(sortRB2)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(sortRB3)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(sortRB4)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(sortRB5)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(sortRB6)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(sortRB7)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(sortRB8)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(sortRB9)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(sortRB10)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(sortRB11)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jRadioButton1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jRadioButton2)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jRadioButton3)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jRadioButton4)
                .addContainerGap(126, Short.MAX_VALUE))
        );

        bOrganizeTabbedPane.addTab("Sort", bSortTab);

        searchPanel.setLayout(new java.awt.BorderLayout());

        searchTF.setText("Search Here");
        searchTF.setToolTipText("");
        searchTF.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                searchTFFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                searchTFFocusLost(evt);
            }
        });
        searchTF.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                searchTFActionPerformed(evt);
            }
        });
        searchPanel.add(searchTF, java.awt.BorderLayout.CENTER);

        searchButton.setText("Search");
        searchButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                searchButtonActionPerformed(evt);
            }
        });
        searchPanel.add(searchButton, java.awt.BorderLayout.LINE_END);

        resultsPanel.setPreferredSize(null);

        javax.swing.GroupLayout resultsPanelLayout = new javax.swing.GroupLayout(resultsPanel);
        resultsPanel.setLayout(resultsPanelLayout);
        resultsPanelLayout.setHorizontalGroup(
            resultsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 584, Short.MAX_VALUE)
        );
        resultsPanelLayout.setVerticalGroup(
            resultsPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 535, Short.MAX_VALUE)
        );

        resultsScrollPane.setViewportView(resultsPanel);

        javax.swing.GroupLayout browseTabLayout = new javax.swing.GroupLayout(browseTab);
        browseTab.setLayout(browseTabLayout);
        browseTabLayout.setHorizontalGroup(
            browseTabLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(browseTabLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(browseTabLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(searchPanel, javax.swing.GroupLayout.DEFAULT_SIZE, 586, Short.MAX_VALUE)
                    .addComponent(resultsScrollPane))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(bOrganizeTabbedPane, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        browseTabLayout.setVerticalGroup(
            browseTabLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(browseTabLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(browseTabLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(bOrganizeTabbedPane, javax.swing.GroupLayout.DEFAULT_SIZE, 566, Short.MAX_VALUE)
                    .addGroup(browseTabLayout.createSequentialGroup()
                        .addComponent(searchPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(resultsScrollPane)))
                .addContainerGap())
        );

        questionsTabbedPane.addTab("Browse", browseTab);

        add(questionsTabbedPane, java.awt.BorderLayout.CENTER);
        questionsTabbedPane.getAccessibleContext().setAccessibleName("questionsTabs");
    }// </editor-fold>//GEN-END:initComponents

    private void searchTFActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_searchTFActionPerformed
        String sqlQuery = buildQuestionQuery();
        System.out.println("SQL Query: " + sqlQuery);
        ResultSet filteredResults = qController.getQuestionsWithFilter(sqlQuery);
        populateResultsPanel(filteredResults);
    }//GEN-LAST:event_searchTFActionPerformed

    private void returnButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_returnButtonActionPerformed
        JFrame frame = (JFrame) SwingUtilities.getWindowAncestor(this);
        CardLayout layout = (CardLayout) frame.getContentPane().getLayout();
        layout.show(frame.getContentPane(), "Home");
    }//GEN-LAST:event_returnButtonActionPerformed

    private void helpButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_helpButtonActionPerformed
        new Help(null, true, 2);
    }//GEN-LAST:event_helpButtonActionPerformed

    private void searchButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_searchButtonActionPerformed
        searchTFActionPerformed(evt);
    }//GEN-LAST:event_searchButtonActionPerformed

    private void newButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_newButtonActionPerformed
        currentQuestionId = null;
        clearFields();
        
        // Clear non-editable fields
        dateCreatedTF.setText("--New--");
        dateEditedTF.setText("--New--");
        dateUsedTF.setText("--Never--");
        usedCountTF.setText("0");

    }//GEN-LAST:event_newButtonActionPerformed

    private void saveButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_saveButtonActionPerformed
        // Validate required fields
        String question = questionTF.getText().trim();
        String questionImagePath = imagePathTF.getText().trim();
        Boolean hasImage = false;

        if (qFormatRadioButton1.isSelected() || qFormatRadioButton3.isSelected()) { // text question format warning
            if (question.isEmpty() || question.equalsIgnoreCase("Question text")) {
                JOptionPane.showMessageDialog(this, "Question text is required", "Error", JOptionPane.ERROR_MESSAGE);
                return;
            }
            if (qFormatRadioButton1.isSelected()) { questionImagePath = ""; }
        }
        if (qFormatRadioButton2.isSelected() || qFormatRadioButton3.isSelected()) { // image question format warning
            if (questionImagePath.isEmpty() || questionImagePath.equalsIgnoreCase("Image Path")) {
                JOptionPane.showMessageDialog(this, "Question Image Path is required", "Error", JOptionPane.ERROR_MESSAGE);
                return;
            }
            if (qFormatRadioButton2.isSelected()) { question = ""; }
            hasImage = true; // Set hasImage to true for image questions
        }

        String cAns = "";
        String wAns1 = "";
        String wAns2 = "";
        String wAns3 = "";
        
        String correctAnswerImagePath = "";
        String wrongAnswer1ImagePath = "";
        String wrongAnswer2ImagePath = "";
        String wrongAnswer3ImagePath = "";

        if (ansTF1.getText().trim().isEmpty() || ansTF1.getText().trim().equalsIgnoreCase("Answer 1") ||
            ansTF2.getText().trim().isEmpty() || ansTF2.getText().trim().equalsIgnoreCase("Answer 2") ||
            ansTF3.getText().trim().isEmpty() || ansTF3.getText().trim().equalsIgnoreCase("Answer 3") ||
            ansTF4.getText().trim().isEmpty() || ansTF4.getText().trim().equalsIgnoreCase("Answer 4")) {
            JOptionPane.showMessageDialog(this, "All answer fields are required", "Error", JOptionPane.ERROR_MESSAGE);
            return;
        }

        if (!ansRadioButton1.isSelected() && !ansRadioButton2.isSelected() &&
            !ansRadioButton3.isSelected() && !ansRadioButton4.isSelected()) {
            JOptionPane.showMessageDialog(this, "Please select the correct answer", "Error", JOptionPane.ERROR_MESSAGE);
            return;
        }
    
        // Get the correct answer
        String correctAnswer = "";
        String cAnsImagePath = ""; // Placeholder for correct answer image path
        if (ansRadioButton1.isSelected()) {
            correctAnswer = ansTF1.getText();
            cAnsImagePath = answer1ImagePath;
        }
        else if (ansRadioButton2.isSelected()){
            correctAnswer = ansTF2.getText();
            cAnsImagePath = answer2ImagePath;
        } 
        else if (ansRadioButton3.isSelected()) {
            correctAnswer = ansTF3.getText();
            cAnsImagePath = answer3ImagePath;
        }
        else if (ansRadioButton4.isSelected()) {
            correctAnswer = ansTF4.getText();
            cAnsImagePath = answer4ImagePath;
        }
        

        // Prepare question data
        //String question = questionTF.getText();
    
        // Initialize list to hold wrong answers
        ArrayList<String> wrongAnswers = new ArrayList<>();
        ArrayList<String> wrongImagePaths = new ArrayList<>();
    
        // Add all answers that aren't the correct one
        if (!ansRadioButton1.isSelected()) wrongAnswers.add(ansTF1.getText());
        if (!ansRadioButton2.isSelected()) wrongAnswers.add(ansTF2.getText());
        if (!ansRadioButton3.isSelected()) wrongAnswers.add(ansTF3.getText());
        if (!ansRadioButton4.isSelected()) wrongAnswers.add(ansTF4.getText());

        String wrong1 = wrongAnswers.get(0);
        String wrong2 = wrongAnswers.get(1);
        String wrong3 = wrongAnswers.get(2);

        if (ansFormatRadioButton1.isSelected()) { // text answers
            cAns = correctAnswer;
            wAns1 = wrong1;
            wAns2 = wrong2;
            wAns3 = wrong3;
        } else { // image answers
            hasImage = true; // Set hasImage to true for image answers

            correctAnswerImagePath = correctAnswer;
            wrongAnswer1ImagePath = wrong1;
            wrongAnswer2ImagePath = wrong2;
            wrongAnswer3ImagePath = wrong3;

            correctAnswer = "";
            wrong1 = "";
            wrong2 = "";
            wrong3 = "";
        }

        
        String courseCode = (String) courseComboBox.getSelectedItem();
        String topicName = (String) topicComboBox.getSelectedItem();
        String subtopicName = (String) subtopicComboBox.getSelectedItem();
        if (courseCode == null || courseCode.equalsIgnoreCase("--None--") ||
            topicName == null || topicName.equalsIgnoreCase("--None--") ||
            subtopicName == null || subtopicName.equalsIgnoreCase("--None--")) {
            JOptionPane.showMessageDialog(this, "Please select a course, topic, and subtopic", "Error", JOptionPane.ERROR_MESSAGE);
            return;
        }
        Integer courseID = courseCodeToIDMap.get(courseCode); // Get the courseID from the map
        Integer topicID = topicNameToIDMap.get(topicName); // Get the topicID from the map
        Integer subtopicID = subtopicNameToIDMap.get(subtopicName); // Get the subtopicID from the map
        
        Float difficulty = ((Number) difficultySpinner.getValue()).floatValue();
        Float performance = ((Number) performanceSpinner.getValue()).floatValue(); 
        Float discrimination = ((Number) discriminationSpinner.getValue()).floatValue();

        String comment = commentTextArea.getText().trim();
        try {
            if (currentQuestionId == null) {
                // Create new question
                boolean success = qController.insertQuestion(
                    question, correctAnswer, wrong1, wrong2, wrong3,
                    courseID, topicID, subtopicID, difficulty, performance, discrimination,
                    hasImage, questionImagePath, correctAnswerImagePath, wrongAnswer1ImagePath, 
                    wrongAnswer2ImagePath, wrongAnswer3ImagePath, comment
                );
    
                if (success) {
                    JOptionPane.showMessageDialog(this, "Question created successfully", "Success", JOptionPane.INFORMATION_MESSAGE);
                    // Refresh the results panel
                    populateResultsPanel(qController.getQuestionsWithFilter());
                } else {
                    JOptionPane.showMessageDialog(this, "Failed to create question", "Error", JOptionPane.ERROR_MESSAGE);
                }
            } else {
                // Update existing question
                boolean success = qController.editQuestion(
                    currentQuestionId,
                    question, correctAnswer, wrong1, wrong2, wrong3,
                    courseID, topicID, subtopicID, difficulty, performance, discrimination,
                    hasImage, questionImagePath, correctAnswerImagePath, wrongAnswer1ImagePath, 
                    wrongAnswer2ImagePath, wrongAnswer3ImagePath, comment
                );
    
                if (success) {
                    JOptionPane.showMessageDialog(this, "Question updated successfully", "Success", JOptionPane.INFORMATION_MESSAGE);
                    // Refresh the results panel
                    populateResultsPanel(qController.getQuestionsWithFilter());
                } else {
                    JOptionPane.showMessageDialog(this, "Failed to update question", "Error", JOptionPane.ERROR_MESSAGE);
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(this, "Error saving question: " + e.getMessage(), "Error", JOptionPane.ERROR_MESSAGE);
        }
        questionImagePath = "";
        answer1ImagePath = "";
        answer2ImagePath = "";
        answer3ImagePath = "";
        answer4ImagePath = "";
    }//GEN-LAST:event_saveButtonActionPerformed

    private void clearButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_clearButtonActionPerformed
        clearFields();
    }//GEN-LAST:event_clearButtonActionPerformed

    private void deleteButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_deleteButtonActionPerformed
        if (currentQuestionId == null) {
            JOptionPane.showMessageDialog(this, "No question selected to delete", "Error", JOptionPane.ERROR_MESSAGE);
            return;
        }
        
        int confirm = JOptionPane.showConfirmDialog(
            this, 
            "Are you sure you want to delete this question?", 
            "Confirm Delete", 
            JOptionPane.YES_NO_OPTION
        );
        
        if (confirm == JOptionPane.YES_OPTION) {
            try {
                boolean success = qController.deleteQuestion(currentQuestionId);
                if (success) {
                    JOptionPane.showMessageDialog(this, "Question deleted successfully", "Success", JOptionPane.INFORMATION_MESSAGE);
                    currentQuestionId = null;
                    clearFields();
                    // Refresh the results panel
                    populateResultsPanel(qController.getQuestionsWithFilter());
                } else {
                    JOptionPane.showMessageDialog(this, "Failed to delete question", "Error", JOptionPane.ERROR_MESSAGE);
                }
            } catch (Exception e) {
                e.printStackTrace();
                JOptionPane.showMessageDialog(this, "Error deleting question: " + e.getMessage(), "Error", JOptionPane.ERROR_MESSAGE);
            }
        }
    }//GEN-LAST:event_deleteButtonActionPerformed

    private void ansTF1FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_ansTF1FocusGained
        if(ansTF1.getText().equals("Answer 1")){
            ansTF1.setText("");
        }
    }//GEN-LAST:event_ansTF1FocusGained

    private void ansTF1FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_ansTF1FocusLost
        if(ansTF1.getText().equals("")){
            ansTF1.setText("Answer 1");
        }
    }//GEN-LAST:event_ansTF1FocusLost

    private void ansTF2FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_ansTF2FocusGained
        if(ansTF2.getText().equals("Answer 2")){
            ansTF2.setText("");
        }
    }//GEN-LAST:event_ansTF2FocusGained

    private void ansTF2FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_ansTF2FocusLost
        if(ansTF2.getText().equals("")){
            ansTF2.setText("Answer 2");
        }
    }//GEN-LAST:event_ansTF2FocusLost

    private void ansTF3FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_ansTF3FocusGained
        if(ansTF3.getText().equals("Answer 3")){
            ansTF3.setText("");
        }
    }//GEN-LAST:event_ansTF3FocusGained

    private void ansTF3FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_ansTF3FocusLost
        if(ansTF3.getText().equals("")){
            ansTF3.setText("Answer 3");
        }
    }//GEN-LAST:event_ansTF3FocusLost

    private void ansTF4FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_ansTF4FocusGained
        if(ansTF4.getText().equals("Answer 4")){
            ansTF4.setText("");
        }
    }//GEN-LAST:event_ansTF4FocusGained

    private void ansTF4FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_ansTF4FocusLost
        if(ansTF4.getText().equals("")){
            ansTF4.setText("Answer 4");
        }
    }//GEN-LAST:event_ansTF4FocusLost

    private void questionTFFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_questionTFFocusGained
        if(questionTF.getText().equals("Question Text")){
            questionTF.setText("");
        }
    }//GEN-LAST:event_questionTFFocusGained

    private void questionTFFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_questionTFFocusLost
        if(questionTF.getText().equals("")){
            questionTF.setText("Question Text");
        }
    }//GEN-LAST:event_questionTFFocusLost

    private void searchTFFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_searchTFFocusGained
        if(searchTF.getText().equals("Search Here")){
            searchTF.setText("");
        }
    }//GEN-LAST:event_searchTFFocusGained

    private void searchTFFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_searchTFFocusLost
        if(searchTF.getText().equals("")){
            searchTF.setText("Search Here");
        }
    }//GEN-LAST:event_searchTFFocusLost

    private void courseComboBoxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_courseComboBoxActionPerformed
    }//GEN-LAST:event_courseComboBoxActionPerformed
    
    private void clearFields() {
        // Clear text fields
        questionTF.setText("Question Text");
        ansTF1.setText("Answer 1");
        ansTF2.setText("Answer 2");
        ansTF3.setText("Answer 3");
        ansTF4.setText("Answer 4");
        imagePathTF.setText("Image Path");
        
        // Clear radio buttons
        ansButtonGroup.clearSelection();
        qFormatButtonGroup.clearSelection();
        ansButtonGroup.clearSelection();

        qFormatRadioButton1.setSelected(true); // Default to text format
        ansFormatRadioButton1.setSelected(true); // Default to text format
        
        // Reset dropdowns to first item
        courseComboBox.setSelectedIndex(0);
        topicComboBox.setSelectedIndex(0);
        subtopicComboBox.setSelectedIndex(0);
        
        //Reset Spinners
        difficultySpinner.setValue(0);
        performanceSpinner.setValue(0);
        discriminationSpinner.setValue(0);

        //Clear text area
        commentTextArea.setText("");
    }

    private String buildQuestionQuery() {
        StringBuilder sql = new StringBuilder("SELECT * FROM questions WHERE 1=1");
        
        // Apply filters
        if (bUsedYesCB.isSelected() && !bUsedNoCB.isSelected()) {
            sql.append(" AND timesUsed > 0");
        } else if (bUsedNoCB.isSelected() && !bUsedYesCB.isSelected()) {
            sql.append(" AND timesUsed = 0");
        }
        
        // Handle range of difficulties
        Float startDifficulty = (Float) jSpinner1.getValue();
        Float endDifficulty = (Float) jSpinner2.getValue();
        if (startDifficulty != null) {
            sql.append(" AND difficulty >= '").append(startDifficulty).append("'");
        }
        if (endDifficulty != null) {
            sql.append(" AND difficulty <= '").append(endDifficulty).append("'");
        }

        Float startPerformance = (Float) jSpinner3.getValue();
        Float endPerformance = (Float) jSpinner4.getValue();
        if (startPerformance != null) {
            sql.append(" AND performance >= '").append(startPerformance).append("'");
        }
        if (endPerformance != null) {
            sql.append(" AND performance <= '").append(endPerformance).append("'");
        }

        Float startDiscrimination = (Float) jSpinner5.getValue();
        Float endDiscrimination = (Float) jSpinner6.getValue();
        if (startDiscrimination != null) {
            sql.append(" AND discrimination >= '").append(startDiscrimination).append("'");
        }
        if (endDiscrimination != null) {
            sql.append(" AND discrimination <= '").append(endDiscrimination).append("'");
        }
        
        // Handle course filter (skip if "--All--" is selected)
        String courseFilter = (String)bCourseComboBox.getSelectedItem();
        if (courseFilter != null && !courseFilter.isEmpty() && !courseFilter.equals("--All--")) {
            Integer courseID = courseCodeToIDMap.get(courseFilter); // Get the courseID from the map
            sql.append(" AND course = '").append(courseID).append("'");
        }
        
        // Handle topic filter (skip if "--All--" is selected)
        String topicFilter = (String)bTopicComboBox.getSelectedItem();
        if (topicFilter != null && !topicFilter.isEmpty() && !topicFilter.equals("--All--")) {
            Integer topicID = topicNameToIDMap.get(topicFilter); // Get the topicID from the map
            sql.append(" AND topic = '").append(topicID).append("'");
        }
        
        // Handle subtopic filter (skip if "--All--" is selected)
        String subtopicFilter = (String)bSubtopicComboBox.getSelectedItem();
        if (subtopicFilter != null && !subtopicFilter.isEmpty() && !subtopicFilter.equals("--All--")) {
            Integer subtopicID = subtopicNameToIDMap.get(subtopicFilter); // Get the subtopicID from the map
            sql.append(" AND subTopic = '").append(subtopicID).append("'");
        }
        
        // Apply search text
        String searchText = searchTF.getText().trim();
        if (searchText != null && !searchText.isEmpty() && !searchText.equals("Search Here")) {
            sql.append(" AND (question LIKE '%").append(searchText).append("%'")
               .append(" OR correctAnswer LIKE '%").append(searchText).append("%'")
               .append(" OR wrongAnswer1 LIKE '%").append(searchText).append("%'")
               .append(" OR wrongAnswer2 LIKE '%").append(searchText).append("%'")
               .append(" OR wrongAnswer3 LIKE '%").append(searchText).append("%')");
        }
        
        // Apply sorting
        String sortOption = getSelectedSortOption();
        switch (sortOption) {
            case "ImagesFirst" -> sql.append(" ORDER BY hasImage DESC");
            case "TextFirst" -> sql.append(" ORDER BY hasImage ASC");
            case "LastUsedOldestFirst" -> sql.append(" ORDER BY lastUsed ASC");
            case "LastUsedNewestFirst" -> sql.append(" ORDER BY lastUsed DESC");
            case "DateCreatedOldestFirst" -> sql.append(" ORDER BY dateCreated ASC");
            case "DateCreatedNewestFirst" -> sql.append(" ORDER BY dateCreated DESC");
            case "TimesUsedLeastFirst" -> sql.append(" ORDER BY timesUsed ASC");
            case "TimesUsedMostFirst" -> sql.append(" ORDER BY timesUsed DESC");
            case "DifficultyEasyFirst" -> sql.append(" ORDER BY difficulty ASC");
            case "DifficultyHardFirst" -> sql.append(" ORDER BY difficulty DESC");
            case "PerformanceLowestFirst" -> sql.append(" ORDER BY performance ASC");
            case "PerformanceHighestFirst" -> sql.append(" ORDER BY performance DESC");
            case "DiscriminationLowestFirst" -> sql.append(" ORDER BY discrimination ASC");
            case "DiscriminationHighestFirst" -> sql.append(" ORDER BY discrimination DESC");
            default -> sql.append(" ORDER BY questionID"); // Default sorting
        }
        
        return sql.toString();
    }
    
    private String getSelectedSortOption() {
        if (sortRB1.isSelected()) return "Default";
        if (sortRB2.isSelected()) return "ImagesFirst";
        if (sortRB3.isSelected()) return "TextFirst";
        if (sortRB4.isSelected()) return "LastUsedOldestFirst";
        if (sortRB5.isSelected()) return "LastUsedNewestFirst";
        if (sortRB6.isSelected()) return "DateCreatedOldestFirst";
        if (sortRB7.isSelected()) return "DateCreatedNewestFirst";
        if (sortRB8.isSelected()) return "TimesUsedLeastFirst";
        if (sortRB9.isSelected()) return "TimesUsedMostFirst";
        if (sortRB10.isSelected()) return "DifficultyEasyFirst";
        if (sortRB11.isSelected()) return "DifficultyHardFirst";
        if (jRadioButton1.isSelected()) return "PerformanceLowestFirst";
        if (jRadioButton2.isSelected()) return "PerformanceHighestFirst";
        if (jRadioButton3.isSelected()) return "DiscriminationLowestFirst";
        if (jRadioButton4.isSelected()) return "DiscriminationHighestFirst";
        return "Default"; // Fallback
    }

    @SuppressWarnings("unused")
    private void populateResultsPanel(ResultSet rs) {
        // Clear the resultsPanel
        resultsPanel.removeAll();
        resultsPanel.setLayout(new BoxLayout(resultsPanel, BoxLayout.Y_AXIS));
        
        // Reset highlighted panel
        lastHighlightedPanel = null;

        try {
            while (rs != null && rs.next()) {
                // Create a panel for each question
                JPanel questionPanel = new JPanel(new BorderLayout());
                questionPanel.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));
                questionPanel.setOpaque(true); // Required for background color to show
                
                // Add question text as a label
                JLabel questionLabel = new JLabel(rs.getString("question"));
                questionPanel.add(questionLabel, BorderLayout.CENTER);
                
                // Make the panel clickable
                questionPanel.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));
                questionPanel.addMouseListener((MouseListener) new MouseAdapter() {
                    @Override
                    public void mouseClicked(MouseEvent e) {
                        // Remove highlight from previously selected panel
                        if (lastHighlightedPanel != null) {
                            lastHighlightedPanel.setBackground(null);
                            lastHighlightedPanel.repaint();
                        }
                        
                        // Highlight the clicked panel
                        questionPanel.setBackground(new Color(173, 216, 230)); // Light blue color
                        lastHighlightedPanel = questionPanel;
                    }
                });
                
                // Add a details button
                JButton detailsButton = new JButton("Details");
                int questionId = rs.getInt("questionID");
                detailsButton.putClientProperty("questionId", questionId);
                
                detailsButton.addActionListener(e -> {
                    // Remove highlight from previously selected panel
                    if (lastHighlightedPanel != null) {
                        lastHighlightedPanel.setBackground(null);
                        lastHighlightedPanel.repaint();
                    }
                    
                    // Highlight the clicked panel
                    questionPanel.setBackground(new Color(173, 216, 230)); // Light blue color
                    lastHighlightedPanel = questionPanel;
                    
                    questionsTabbedPane.setSelectedIndex(0); // Switch to Manage tab
                    loadQuestionData(questionId);
                });
                
                questionPanel.add(detailsButton, BorderLayout.EAST);
                resultsPanel.add(questionPanel);
                resultsPanel.add(Box.createRigidArea(new Dimension(0, 5)));
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
        
        resultsPanel.add(Box.createVerticalGlue());
        resultsPanel.revalidate();
        resultsPanel.repaint();
    }

    private void loadQuestionData(int questionId) {
        try {
            this.currentQuestionId = questionId;

            // Fetch question details from the database
            ResultSet rs = qController.getQuestion(questionId);
            
            if (rs.next()) {
                System.out.println("Loading question ID: " + questionId);
                System.out.println("Question Text: " + rs.getString("question"));
                System.out.println("C Ans Text: " + rs.getString("correctAnswer"));
                System.out.println("Question Img Path: " + rs.getString("questionImagePath"));
                System.out.println("C Ans Img Path: " + rs.getString("correctAnswerImagePath"));
                if (!rs.getString("question").isEmpty() && !rs.getString("questionImagePath").isEmpty()) {
                    qFormatRadioButton3.setSelected(true);
                    questionTF.setText(rs.getString("question"));
                    imagePathTF.setText(rs.getString("questionImagePath"));
                } else if (!rs.getString("questionImagePath").isEmpty()) {
                    qFormatRadioButton2.setSelected(true);
                    imagePathTF.setText(rs.getString("questionImagePath"));
                } else {
                    qFormatRadioButton1.setSelected(true);
                    questionTF.setText(rs.getString("question"));
                }
                updateQuestionFormat();

                // Fill answer fields (assuming 4 answers)
                if (!rs.getString("correctAnswerImagePath").isEmpty()) {
                    ansFormatRadioButton2.setSelected(true);

                    ansTF1.setText(rs.getString("correctAnswerImagePath"));
                    ansTF2.setText(rs.getString("wrongAnswer1ImagePath"));
                    ansTF3.setText(rs.getString("wrongAnswer2ImagePath"));
                    ansTF4.setText(rs.getString("wrongAnswer3ImagePath"));
                } else {
                    ansFormatRadioButton1.setSelected(true);

                    ansTF1.setText(rs.getString("correctAnswer"));
                    ansTF2.setText(rs.getString("wrongAnswer1"));
                    ansTF3.setText(rs.getString("wrongAnswer2"));
                    ansTF4.setText(rs.getString("wrongAnswer3"));
                }
                updateAnswerFormat();
                
                // Set correct answer (assuming radio buttons)
                ansRadioButton1.setSelected(true);
                
                // Fill tags (course, topic, subtopic, difficulty)
                Integer courseID = rs.getInt("course");
                Integer topicID = rs.getInt("topic");
                Integer subtopicID = rs.getInt("subTopic");

                String courseCode = cController.getCourseCodeById(courseID);
                String topicName = tController.getTopicNameById(topicID);
                String subtopicName = sController.getSubtopicName(subtopicID);
                
                courseComboBox.setSelectedItem(courseCode);
                topicComboBox.setSelectedItem(topicName);
                subtopicComboBox.setSelectedItem(subtopicName);
                
                // Fill history tags
                SimpleDateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
                SimpleDateFormat outputFormat = new SimpleDateFormat("yyyy-MM-dd");

                String dateCreated = rs.getString("dateCreated");
                String dateEdited = rs.getString("lastEdited");
                String lastUsed = rs.getString("lastUsed");

                if (dateCreated != null) {
                    dateCreatedTF.setText(outputFormat.format(inputFormat.parse(dateCreated)));
                } else {
                    dateCreatedTF.setText("--New--");
                }

                if (dateEdited != null) {
                    dateEditedTF.setText(outputFormat.format(inputFormat.parse(dateEdited)));
                } else {
                    dateEditedTF.setText("--New--");
                }

                if (lastUsed != null) {
                    dateUsedTF.setText(outputFormat.format(inputFormat.parse(lastUsed)));
                } else {
                    dateUsedTF.setText("--Never--");
                }

                usedCountTF.setText(String.valueOf(rs.getInt("timesUsed")));

                // Fill performance, discrimination, and difficulty
                difficultySpinner.setValue(rs.getFloat("difficulty"));
                performanceSpinner.setValue(rs.getFloat("performance"));
                discriminationSpinner.setValue(rs.getFloat("discrimination"));

                commentTextArea.setText(rs.getString("comment"));
            }
        } catch (SQLException e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(this, "Failed to load question data.", "Error", JOptionPane.ERROR_MESSAGE);
        } catch (ParseException e) {
            e.printStackTrace();
        }
    }

    private void populateDropdowns() {
        // Clear existing items
        bCourseComboBox.removeAllItems();
        bTopicComboBox.removeAllItems();
        bSubtopicComboBox.removeAllItems();
        courseComboBox.removeAllItems();
        topicComboBox.removeAllItems();
        subtopicComboBox.removeAllItems();
        courseCodeToIDMap.clear();
        topicNameToIDMap.clear();
        subtopicNameToIDMap.clear();
    
        // Add default options
        bCourseComboBox.addItem(DEFAULT_ALL_OPTION);
        bTopicComboBox.addItem(DEFAULT_ALL_OPTION);
        bSubtopicComboBox.addItem(DEFAULT_ALL_OPTION);
        courseComboBox.addItem(DEFAULT_NONE_OPTION);
        topicComboBox.addItem(DEFAULT_NONE_OPTION);
        subtopicComboBox.addItem(DEFAULT_NONE_OPTION);
    
        // Get distinct values from database
        ArrayList<String[]> courses = cController.getAllCourses();
        
        // Populate course dropdowns
        for (String[] course : courses) {
            String courseCode = course[0];
            int courseID = Integer.parseInt(course[1]);
            bCourseComboBox.addItem(courseCode);
            courseComboBox.addItem(courseCode);
            courseCodeToIDMap.put(courseCode, courseID);
        }
    
        // Initially disable dependent dropdowns
        bTopicComboBox.setEnabled(false);
        bSubtopicComboBox.setEnabled(false);
        topicComboBox.setEnabled(false);
        subtopicComboBox.setEnabled(false);
    }

    @SuppressWarnings("unused")
    private void setupBrowseDropdownListeners() {
        bCourseComboBox.addActionListener(e -> {
            String selectedCourse = (String) bCourseComboBox.getSelectedItem();
            if (DEFAULT_ALL_OPTION.equals(selectedCourse)) {
                bTopicComboBox.setEnabled(false);
                bSubtopicComboBox.setEnabled(false);
                bTopicComboBox.setSelectedItem(DEFAULT_ALL_OPTION);
                bSubtopicComboBox.setSelectedItem(DEFAULT_ALL_OPTION);
            } else {
                Integer courseID = courseCodeToIDMap.get(selectedCourse);
                bTopicComboBox.setEnabled(true);
                populateTopicsDropdown(bTopicComboBox, courseID, true);
            }
        });

        bTopicComboBox.addActionListener(e -> {
            String selectedTopic = (String) bTopicComboBox.getSelectedItem();
            if (DEFAULT_ALL_OPTION.equals(selectedTopic)) {
                bSubtopicComboBox.setEnabled(false);
                bSubtopicComboBox.setSelectedItem(DEFAULT_ALL_OPTION);
            } else {
                bSubtopicComboBox.setEnabled(true);
                populateSubtopicsDropdown(bSubtopicComboBox, selectedTopic, true);
            }
        });
    }

    @SuppressWarnings("unused")
    private void setupManageDropdownListeners() {
        courseComboBox.addActionListener(e -> {
            String selectedCourse = (String) courseComboBox.getSelectedItem();
            if (DEFAULT_NONE_OPTION.equals(selectedCourse)) {
                topicComboBox.setEnabled(false);
                subtopicComboBox.setEnabled(false);
                topicComboBox.setSelectedItem(DEFAULT_NONE_OPTION);
                subtopicComboBox.setSelectedItem(DEFAULT_NONE_OPTION);
            } else {
                Integer courseID = courseCodeToIDMap.get(selectedCourse);
                topicComboBox.setEnabled(true);
                populateTopicsDropdown(topicComboBox, courseID, false);
            }
        });

        topicComboBox.addActionListener(e -> {
            String selectedTopic = (String) topicComboBox.getSelectedItem();
            if (DEFAULT_NONE_OPTION.equals(selectedTopic)) {
                subtopicComboBox.setEnabled(false);
                subtopicComboBox.setSelectedItem(DEFAULT_NONE_OPTION);
            } else {
                subtopicComboBox.setEnabled(true);
                populateSubtopicsDropdown(subtopicComboBox, selectedTopic, false);
            }
        });
    }

    private void populateTopicsDropdown(JComboBox<String> topicDropdown, Integer courseID, boolean includeAllOption) {
        topicDropdown.removeAllItems();
        if (includeAllOption) {
            topicDropdown.addItem(DEFAULT_ALL_OPTION);
        } else {
            topicDropdown.addItem(DEFAULT_NONE_OPTION);
        }

        ArrayList<String[]> topics = tController.getTopicsByCourseId(courseID);
        for (String[] topic : topics) {
            String topicName = topic[0];
            topicDropdown.addItem(topicName);
            topicNameToIDMap.put(topicName, Integer.parseInt(topic[1])); // Map topicName to topicID
        }
    }

    private void populateSubtopicsDropdown(JComboBox<String> subtopicDropdown, String topicName, boolean includeAllOption) {
        subtopicDropdown.removeAllItems();
        if (includeAllOption) {
            subtopicDropdown.addItem(DEFAULT_ALL_OPTION);
        } else {
            subtopicDropdown.addItem(DEFAULT_NONE_OPTION);
        }

        // Get the topicID from the topicNameToIDMap
        Integer topicID = topicNameToIDMap.get(topicName);
        if (topicID == null) {
            System.err.println("Error: topicID is null for topicName: " + topicName);
            return; // Exit early if topicID is null
        }

        // Fetch subtopics using the topicID
        ArrayList<String[]> subtopics = sController.getSubtopicsByTopicId(topicID);
        for (String[] subtopic : subtopics) {
            String subtopicName = subtopic[0];
            subtopicDropdown.addItem(subtopicName);
            subtopicNameToIDMap.put(subtopicName, Integer.parseInt(subtopic[1])); // Map subtopicName to subtopicID
        }
    }

    @SuppressWarnings("unused")
    private void setupFormatListeners() {
        // Question Format Radio Buttons
        qFormatRadioButton1.addActionListener(e -> updateQuestionFormat());
        qFormatRadioButton2.addActionListener(e -> updateQuestionFormat());
        qFormatRadioButton3.addActionListener(e -> updateQuestionFormat());
    
        // Answer Format Radio Buttons
        ansFormatRadioButton1.addActionListener(e -> updateAnswerFormat());
        ansFormatRadioButton2.addActionListener(e -> updateAnswerFormat());
    }
    
    @SuppressWarnings("unused")
    private void setupImageButtonListeners() {
        // Question image button
        qImageButton.addActionListener(e -> {
            String imagePath = selectImageFile();
            if (imagePath != null) {
                imagePathTF.setText(imagePath);
                questionImagePath = imagePath;
            
            }
        });
        
        // Answer image buttons
        ansImageButton1.addActionListener(e -> {
            String imagePath = selectImageFile();
            if (imagePath != null) {
                answer1ImagePath = imagePath;
                ansTF1.setText(imagePath);
                //ansImageCB1.setSelected(true);
                // You might want to store this path somewhere or add a text field for it
            }
        });
        
        ansImageButton2.addActionListener(e -> {
            String imagePath = selectImageFile();
            if (imagePath != null) {
                answer2ImagePath = imagePath;
                ansTF2.setText(imagePath);
                //ansImageCB2.setSelected(true);
            }
        });
        
        ansImageButton3.addActionListener(e -> {
            String imagePath = selectImageFile();
            if (imagePath != null) {
                answer3ImagePath = imagePath;
                ansTF3.setText(imagePath);
                //ansImageCB3.setSelected(true);
            }
        });
        
        ansImageButton4.addActionListener(e -> {
            String imagePath = selectImageFile();
            if (imagePath != null) {
                answer4ImagePath = imagePath;
                ansTF4.setText(imagePath);
                //ansImageCB4.setSelected(true);
            }
        });
    }

    private String selectImageFile() {
        JFileChooser fileChooser = new JFileChooser();
        
        // Set filter for image files only
        FileNameExtensionFilter filter = new FileNameExtensionFilter(
            "Image Files", "jpg", "jpeg", "png");
        fileChooser.setFileFilter(filter);
        
        int returnValue = fileChooser.showOpenDialog(this);
        
        if (returnValue == JFileChooser.APPROVE_OPTION) {
            return fileChooser.getSelectedFile().getAbsolutePath();
        }
        return null;
    }

    private void updateQuestionFormat() {
        if (qFormatRadioButton1.isSelected()) { // Text
            questionTF.setEnabled(true);
            qImageButton.setEnabled(false);
            imagePathTF.setEnabled(false);
        } else if (qFormatRadioButton2.isSelected()) { // Image
            questionTF.setEnabled(false);
            qImageButton.setEnabled(true);
            imagePathTF.setEnabled(true);
        } else if (qFormatRadioButton3.isSelected()) { // Text and Image
            questionTF.setEnabled(true);
            qImageButton.setEnabled(true);
            imagePathTF.setEnabled(true);
        }
    }
    
    private void updateAnswerFormat() {
        if (ansFormatRadioButton1.isSelected()) { // Text
            ansTF1.setFocusable(true);
            ansTF2.setFocusable(true);
            ansTF3.setFocusable(true);
            ansTF4.setFocusable(true);
            
            ansTF1.setEditable(true);
            ansTF2.setEditable(true);
            ansTF3.setEditable(true);
            ansTF4.setEditable(true);

            ansImageButton1.setEnabled(false);
            ansImageButton2.setEnabled(false);
            ansImageButton3.setEnabled(false);
            ansImageButton4.setEnabled(false);
        } else if (ansFormatRadioButton2.isSelected()) { // Images
            ansTF1.setFocusable(false);
            ansTF2.setFocusable(false);
            ansTF3.setFocusable(false);
            ansTF4.setFocusable(false);

            ansTF1.setEditable(false);
            ansTF2.setEditable(false);
            ansTF3.setEditable(false);
            ansTF4.setEditable(false);

            ansImageButton1.setEnabled(true);
            ansImageButton2.setEnabled(true);
            ansImageButton3.setEnabled(true);
            ansImageButton4.setEnabled(true);
        }
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.ButtonGroup ansButtonGroup;
    private javax.swing.ButtonGroup ansFormatButtonGroup;
    private javax.swing.JLabel ansFormatLabel;
    private javax.swing.JRadioButton ansFormatRadioButton1;
    private javax.swing.JRadioButton ansFormatRadioButton2;
    private javax.swing.JButton ansImageButton1;
    private javax.swing.JButton ansImageButton2;
    private javax.swing.JButton ansImageButton3;
    private javax.swing.JButton ansImageButton4;
    private javax.swing.JRadioButton ansRadioButton1;
    private javax.swing.JRadioButton ansRadioButton2;
    private javax.swing.JRadioButton ansRadioButton3;
    private javax.swing.JRadioButton ansRadioButton4;
    private javax.swing.JTextField ansTF1;
    private javax.swing.JTextField ansTF2;
    private javax.swing.JTextField ansTF3;
    private javax.swing.JTextField ansTF4;
    private javax.swing.JComboBox<String> bCourseComboBox;
    private javax.swing.JPanel bCoursePanel;
    private javax.swing.JPanel bDifficultyPanel;
    private javax.swing.JPanel bFilterPanel;
    private javax.swing.JScrollPane bFilterScrollTab;
    private javax.swing.JTabbedPane bOrganizeTabbedPane;
    private javax.swing.JPanel bSortTab;
    private javax.swing.JComboBox<String> bSubtopicComboBox;
    private javax.swing.JPanel bSubtopicPanel;
    private javax.swing.JComboBox<String> bTopicComboBox;
    private javax.swing.JPanel bTopicPanel;
    private javax.swing.JCheckBox bUsedNoCB;
    private javax.swing.JPanel bUsedPanel;
    private javax.swing.JCheckBox bUsedYesCB;
    private javax.swing.JPanel browseTab;
    private javax.swing.JPanel categoryTagsPanel;
    private javax.swing.JButton clearButton;
    private javax.swing.JPanel commentPanel;
    private javax.swing.JScrollPane commentScrollPane;
    private javax.swing.JTextArea commentTextArea;
    private javax.swing.JComboBox<String> courseComboBox;
    private javax.swing.JLabel courseLabel;
    private javax.swing.JLabel dateCreatedLabel;
    private javax.swing.JTextField dateCreatedTF;
    private javax.swing.JLabel dateEditedLabel;
    private javax.swing.JTextField dateEditedTF;
    private javax.swing.JLabel dateUsedLabel;
    private javax.swing.JTextField dateUsedTF;
    private javax.swing.JButton deleteButton;
    private javax.swing.JLabel difficultyLabel;
    private javax.swing.JSpinner difficultySpinner;
    private javax.swing.JLabel discriminationLabel;
    private javax.swing.JSpinner discriminationSpinner;
    private javax.swing.JPanel headerPanel;
    private javax.swing.JButton helpButton;
    private javax.swing.JPanel historyTagsPanel;
    private javax.swing.JTextField imagePathTF;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JRadioButton jRadioButton1;
    private javax.swing.JRadioButton jRadioButton2;
    private javax.swing.JRadioButton jRadioButton3;
    private javax.swing.JRadioButton jRadioButton4;
    private javax.swing.JSpinner jSpinner1;
    private javax.swing.JSpinner jSpinner2;
    private javax.swing.JSpinner jSpinner3;
    private javax.swing.JSpinner jSpinner4;
    private javax.swing.JSpinner jSpinner5;
    private javax.swing.JSpinner jSpinner6;
    private javax.swing.JPanel manageAnswersPanel;
    private javax.swing.JPanel manageControlsPanel;
    private javax.swing.JPanel manageQuestionPanel;
    private javax.swing.JPanel manageScrollContentPanel;
    private javax.swing.JScrollPane manageScrollTab;
    private javax.swing.JPanel manageTagsPanel;
    private javax.swing.JButton newButton;
    private javax.swing.JPanel perfTagsPanel;
    private javax.swing.JLabel performanceLabel;
    private javax.swing.JSpinner performanceSpinner;
    private javax.swing.ButtonGroup qFormatButtonGroup;
    private javax.swing.JLabel qFormatLabel;
    private javax.swing.JRadioButton qFormatRadioButton1;
    private javax.swing.JRadioButton qFormatRadioButton2;
    private javax.swing.JRadioButton qFormatRadioButton3;
    private javax.swing.JButton qImageButton;
    private javax.swing.JTextField questionTF;
    private javax.swing.JLabel questionsLabel;
    private javax.swing.JTabbedPane questionsTabbedPane;
    private javax.swing.JPanel resultsPanel;
    private javax.swing.JScrollPane resultsScrollPane;
    private javax.swing.JButton returnButton;
    private javax.swing.JButton saveButton;
    private javax.swing.JButton searchButton;
    private javax.swing.JPanel searchPanel;
    private javax.swing.JTextField searchTF;
    private javax.swing.ButtonGroup sortButtonGroup;
    private javax.swing.JRadioButton sortRB1;
    private javax.swing.JRadioButton sortRB10;
    private javax.swing.JRadioButton sortRB11;
    private javax.swing.JRadioButton sortRB2;
    private javax.swing.JRadioButton sortRB3;
    private javax.swing.JRadioButton sortRB4;
    private javax.swing.JRadioButton sortRB5;
    private javax.swing.JRadioButton sortRB6;
    private javax.swing.JRadioButton sortRB7;
    private javax.swing.JRadioButton sortRB8;
    private javax.swing.JRadioButton sortRB9;
    private javax.swing.JComboBox<String> subtopicComboBox;
    private javax.swing.JLabel subtopicLabel;
    private javax.swing.JComboBox<String> topicComboBox;
    private javax.swing.JLabel topicLabel;
    private javax.swing.JLabel usedCountLabel;
    private javax.swing.JTextField usedCountTF;
    // End of variables declaration//GEN-END:variables
}
